---
title: Gmail Database Schema
description: Database entities and querying synced Gmail data.
---

The Gmail plugin automatically syncs data from Gmail to your database. This allows you to query Gmail data without making API calls, providing faster access and offline capabilities.

<Callout type="info">
**New to Corsair?** Learn about core concepts like [database operations](/concepts/database), [data synchronization](/concepts/integrations), and [multi-tenancy](/concepts/multi-tenancy) before working with the database.
</Callout>

<Callout>
**Full Implementation:** For the complete, up-to-date database schema and implementations, see the [Gmail plugin source code](https://github.com/corsairdev/corsair/tree/main/packages/corsair/plugins/gmail) on GitHub.
</Callout>

## Synced Entities

The Gmail plugin syncs the following entities to your database:

- **messages** - Email messages and metadata
- **labels** - Gmail labels
- **drafts** - Draft messages
- **threads** - Email conversation threads

## Database API

Access synced data through the `db` property:

```ts
const messages = await corsair.gmail.db.messages.search({
    data: { from: "example@gmail.com" },
});
```

### Search Options

All entity searches support the following options:

```ts
await corsair.gmail.db.messages.search({
    data: { from: "example@gmail.com" },
    limit: 100,
    offset: 0,
});
```

---

## Messages

Messages are synced when you list, get, or receive message webhooks.

### Schema

```ts
{
    id: string;
    threadId?: string;
    labelIds?: string[];
    snippet?: string;
    historyId?: string;
    internalDate?: string;
    sizeEstimate?: number;
    payload?: MessagePart;
    raw?: string;
    subject?: string;
    body?: string;
    from?: string;
    to?: string;
    createdAt?: Date | null;
}
```

### Querying Messages

**Search by sender:**

```ts
const messages = await corsair.gmail.db.messages.search({
    data: { from: "example@gmail.com" },
});
```

**Search by subject:**

```ts
const messages = await corsair.gmail.db.messages.search({
    data: { subject: "Important" },
});
```

**Search by label:**

```ts
const inboxMessages = await corsair.gmail.db.messages.search({
    data: { labelIds: ["INBOX"] },
});
```

---

## Labels

Labels are synced when you list or get labels.

### Schema

```ts
{
    id: string;
    name?: string;
    messageListVisibility?: 'show' | 'hide';
    labelListVisibility?: 'labelShow' | 'labelShowIfUnread' | 'labelHide';
    type?: 'system' | 'user';
    messagesTotal?: number;
    messagesUnread?: number;
    threadsTotal?: number;
    threadsUnread?: number;
    createdAt?: Date | null;
}
```

### Querying Labels

**Search by name:**

```ts
const labels = await corsair.gmail.db.labels.search({
    data: { name: "Important" },
});
```

**Find user-created labels:**

```ts
const userLabels = await corsair.gmail.db.labels.search({
    data: { type: "user" },
});
```

---

## Drafts

Drafts are synced when you list, get, or create drafts.

### Schema

```ts
{
    id: string;
    messageId?: string;
    createdAt?: Date | null;
}
```

### Querying Drafts

**Get all drafts:**

```ts
const drafts = await corsair.gmail.db.drafts.search({
    data: {},
});
```

---

## Threads

Threads are synced when you list or get threads.

### Schema

```ts
{
    id: string;
    snippet?: string;
    historyId?: string;
    createdAt?: Date | null;
}
```

### Querying Threads

**Get all threads:**

```ts
const threads = await corsair.gmail.db.threads.search({
    data: {},
});
```

---

## Multi-Tenancy

When using multi-tenancy, all database queries are automatically scoped to the tenant:

```ts
const tenant = corsair.withTenant("tenant-id");

const messages = await tenant.gmail.db.messages.search({
    data: { from: "example@gmail.com" },
});
```

Each tenant's data is isolated in the database.

---

## Data Synchronization

### When Data is Synced

Data is automatically synced to your database in the following scenarios:

1. **API Calls** - When you call API endpoints, responses are synced
2. **Webhooks** - When webhooks are received, data is updated
3. **Automatic Updates** - Webhook events trigger updates for related entities

### Manual Syncing

You can trigger syncs manually by calling API endpoints:

```ts
await corsair.gmail.api.messages.list({
    maxResults: 100,
});

await corsair.gmail.api.labels.list({});
```

See [Database](/concepts/database) for more information about database concepts and querying patterns.
