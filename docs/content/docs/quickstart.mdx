---
title: Quickstart
description: Get up and running with Corsair in 5 steps
---

import { Callout } from 'fumadocs-ui/components/callout'

## 1. Create Corsair Config

Create a `corsair.config.ts` file in your project root:

```ts title="corsair.config.ts"
import { config as dotenvConfig } from 'dotenv'
import { type CorsairConfig } from 'corsair'
import { db } from './db'

dotenvConfig({ path: '.env.local' })

export const config = {
  dbType: 'postgres',
  orm: 'drizzle',
  framework: 'nextjs',
  pathToCorsairFolder: './corsair',
  apiEndpoint: process.env.NEXT_PUBLIC_CORSAIR_API_ROUTE!,
  db: db,
  schema: db._.schema,
  connection: process.env.DATABASE_URL!,
} satisfies CorsairConfig<typeof db>

export type Config = typeof config
```

## 2. Set Environment Variables

Add to your `.env.local`:

```bash title=".env.local"
DATABASE_URL=postgresql://user:password@localhost:5432/mydb
NEXT_PUBLIC_CORSAIR_API_ROUTE=/api/corsair
```

## 3. Create Procedure File

Create `corsair/procedure.ts` to set up your tRPC context:

```ts title="corsair/procedure.ts"
import { createCorsairTRPC } from 'corsair'
import { config } from '../corsair.config'

export type DatabaseContext = {
  db: typeof config.db
  schema: Exclude<typeof config.schema, undefined>
  userId?: string
}

const t = createCorsairTRPC<DatabaseContext>()
export const { router, procedure } = t
```

## 4. Define Your First Query

Create `corsair/queries/get-all-albums.ts`:

```ts title="corsair/queries/get-all-albums.ts"
import { z } from 'corsair'
import { procedure } from '../procedure'

export const getAllAlbums = procedure
  .input(z.object({}))
  .query(async ({ input, ctx }) => {
    const albums = await ctx.db.select().from(ctx.db._.fullSchema.albums)
    return albums
  })
```

## 5. Create Router and API Route

Create `corsair/index.ts`:

```ts title="corsair/index.ts"
import { dualKeyOperationsMap } from 'corsair'
import { router } from './procedure'
import * as queries from './queries'
import * as mutations from './mutations'

export const corsairRouter = router({
  ...dualKeyOperationsMap(queries),
  ...dualKeyOperationsMap(mutations),
})

export type CorsairRouter = typeof corsairRouter
```

Create `app/api/corsair/[...corsair]/route.ts`:

```ts title="app/api/corsair/[...corsair]/route.ts"
import { fetchRequestHandler } from 'corsair'
import { corsairRouter } from '@/corsair/index'
import { db } from '@/db'

const handler = async (req: Request) => {
  return fetchRequestHandler({
    endpoint: '/api/corsair',
    req,
    router: corsairRouter,
    createContext: () => {
      return {
        userId: '123',
        db,
        schema: db._.schema!,
      }
    },
  })
}

export const GET = handler
export const POST = handler
```

<Callout type="info" title="Next Steps">
  Continue to Core Concepts to learn how to use your queries in client components.
</Callout>

