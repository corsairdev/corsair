---
title: CLI
description: Command-line tools for code generation, validation, and migrations
---

import { Callout } from 'fumadocs-ui/components/callout'

<Callout type="info" title="Built for AI Agents">
  Corsair CLI is designed to work with AI coding agents like Claude Code and
  Cursor.
</Callout>

## Available Commands

### Watch Mode

Start the interactive development UI with watch mode:

```bash
pnpm corsair watch
```

This starts an interactive UI that watches for schema changes and automatically
validates your queries and mutations. It provides real-time feedback on type safety
and schema compatibility.

### Generate

Generate types and validate your Corsair configuration:

```bash
pnpm corsair generate
```

This command generates TypeScript types for your queries and mutations based on
your schema and validates that all operations are properly typed.

### Check

Validate your queries and mutations without generating files:

```bash
pnpm corsair check
```

Runs validation checks on your Corsair operations to ensure they're correctly
structured and type-safe. Useful in CI/CD pipelines.

### Fix

Automatically fix common issues in your Corsair code:

```bash
pnpm corsair fix
```

Attempts to automatically fix common issues like missing exports, incorrect
imports, or simple type errors.

### Migrate

Run database migrations (integrates with your ORM's migration tool):

```bash
pnpm corsair migrate
```

For Drizzle projects, this runs `drizzle-kit push` to sync your
schema with your database.

## AI Agent Commands

<Callout type="warn" title="Important for AI Agents">
  Agents MUST use these CLI commands to generate queries and mutations. DO NOT
  write query/mutation code manually. The CLI ensures proper type safety,
  exports, and schema alignment.
</Callout>

Corsair has specialized commands designed for AI coding agents to generate
queries and mutations using natural language:

### Query Generation

Generate a new query with the `-n` (name) and `-i` (instructions) flags:

```bash
pnpm corsair query -n "get all albums by artist id" -i "return all albums in descending order (recent ones first)"
```

**More Query Examples:**

```bash
pnpm corsair query -n "get posts with authors" -i "fetch all posts with author details from posts and users tables"
```

```bash
pnpm corsair query -n "get comments by post id" -i "get all comments for a specific post ID including author information"
```

```bash
pnpm corsair query -n "get user profile" -i "fetch user profile with their posts count and recent activity"
```

### Mutation Generation

Generate a new mutation:

```bash
pnpm corsair mutation -n "create album" -i "create a new album with validation"
```

**More Mutation Examples:**

```bash
pnpm corsair mutation -n "create post" -i "create a new post with title, content, and author ID"
```

```bash
pnpm corsair mutation -n "update comment" -i "update an existing comment's content by comment ID"
```

```bash
pnpm corsair mutation -n "delete post" -i "delete a post and all its associated comments by post ID"
```

### Updating Existing Queries/Mutations

Use the `-u` flag to update an existing query or mutation:

```bash
pnpm corsair query -n "get posts with authors" -i "fetch all published posts with author details, sorted by created date" -u
```

```bash
pnpm corsair mutation -n "create album" -i "create a new album with validation and send Slack notification" -u
```

### How It Works

When you run these commands, Corsair:

1. **Generates the file** in the appropriate folder (`corsair/queries/` or `corsair/mutations/`)
2. **Auto-exports** the procedure in the index.ts file
3. **Returns the path** where the query/mutation was generated
4. **Validates types** against your schema

<Callout type="info" title="Natural Language">
  These commands accept natural language descriptions and generate type-safe
  TypeScript code that matches your database schema. Be as specific as possible
  in your instructions for better results.
</Callout>

## Configuration

The CLI reads from your `corsair.config.ts` file. Make sure it's
properly configured before running CLI commands:

```ts title="corsair.config.ts"
import { type CorsairConfig } from 'corsair'
import { db } from './db'

export const config = {
  dbType: 'postgres',
  orm: 'drizzle',
  framework: 'nextjs',
  pathToCorsairFolder: './corsair',
  apiEndpoint: process.env.NEXT_PUBLIC_CORSAIR_API_ROUTE!,
  db: db,
  schema: db._.schema,
  connection: process.env.DATABASE_URL!,
} satisfies CorsairConfig<typeof db>
```

## CI/CD Integration

Add Corsair checks to your CI pipeline:

```yaml title=".github/workflows/ci.yml"
name: CI
on: [push, pull_request]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm install
      - run: npm run corsair check
      - run: npm run typecheck
```

<Callout type="warn" title="Schema-Aware Validation">
  When your database schema changes, Corsair will detect affected queries and
  mutations during the check command, preventing runtime errors.
</Callout>
